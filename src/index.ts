import { Transfer } from '@iota/core/typings/types';
import DateTag from './DateTag';
import { EDataTypes, IRequestMsg } from './typings/messages/WelcomeMsg';

/* istanbul ignore file */

// Require the IOTA libraries
const Iota = require('@iota/core');
const Converter = require('@iota/converter');

// Create a new instance of the IOTA object
// Use the `provider` field to specify which IRI node to connect to
const iota = Iota.composeAPI({
  // provider: 'https://nodes.devnet.iota.org:443',
  provider: 'https://nodes.thetangle.org:443',
});

const address =
  'AAAAAWORLDHELLOWORLDHELLOWORLDHELLOWORLDHELLOWORLDHELLOWORLDHELLOWORLDHELLOWORLDDWXHNRIGPX';

const seed =
  'PUEOTSEITFEVEWCWBTSIZM9NKRGJEIMXTULBACGFRQK9IMGICLBKW9TTEVSDQMGWKBXPVCBMMCXWMNPDX';
const requestMsg: IRequestMsg = {
  dataType: EDataTypes.heartRate,
  endDate: new DateTag(2019, 12, 15),
  nextAddress: address,
  pubKey:
    'VAQAXAQAUAQA9BQAVA9BQAWAVAUAQAWABBQAWAWACBQAWAYAQAVAQAVAABBBQAVABBCBQAYAZAQAVAWAUAQAVA9BXAQAWAWA9BQAWAWAABQAWABBQABBQAVABBBBQAVAABVAQAVAYA9BQAVAWAQAZAXAQAYACBQAABZAQAVA9BWAQAXAABQAWAABQACBXAQAVA9BYAQAVAZACBQAWAWAYAQAWAVABBQAVA9BBBQA9BWAQABBYAQAWAUAABQAWAYAWAQAZAWAQAVABBABQAZAYAQAXAYAQAVAYACBQAWAVAABQAVAABXAQAVACBQA9BZAQABBYAQAVAWAUAQAVAABYAQAYAABQACBVAQABBYAQAVACBUAQAWAUABBQAVAYABBQAWAUAABQAWAUABBQAVA9BUAQAVABBQAABVAQAVAZACBQABBUAQAVACB9BQAVAYAWAQAYAWAQAWAUACBQAVAZAXAQABBZAQAXA9BQAVAYAYAQAVAYAWAQAUAQABB9BQAWAVAABQAVABBVAQAVAUAZAQAZACBQAVAVA9BQAVAWAVAQAXACBQAVAZAWAQAWAXAQAYAZAQAWAYAABQAVAABUAQACBZAQACBVAQAWAVAWAQAWAYAWAQAWAZAYAQAVAWAYAQAZAVAQABBYAQAVAVA9BQAXAQAYAQAVAUAVAQAWAYAQAWAWA9BQAZAWAQACB9BQAWAQAWAUACBQAVABBWAQAWAYAZAQAVAABYAQAZAVAQAVAVAQAYA9BQACBQAABABQAWAZAVAQAWAWAYAQAWAWAABQAZA9BQAVAUABBQA9BYAQAWAWAXAQABBQAVAVACBQAVA9BCBQAWAWAABQAZAVAQAWAUAQAVACBZAQAXABBQAVAXAXAQAWAXAUAQAABVAQAVAUAUAQAVACBZAQA9BWAQAZAWAQAVAZACBQAVA9BUAQAWAXAABQAWAUAUAQAVAXACBQAVAWAQAABYAQABB9BQAVAYABBQAVAVAQAWAVAABQAVAAB9BQAZAXAQAVAWAYAQACBVAQAWAXACBQAYAYAQAVAZACBQAWAVACBQAVACBYAQAVAYAXAQAVAVA9BQAVAXAYAQAVACBQAWAXACBQAXAQACBBBQAXAABQAVAVAYAQAABBBQAWAVAUAQACB9BQAVAYAYAQAWAXAWAQAVACBYAQAVAUA9BQAWAVACBQAVA9BUAQAWAWAVAQAWAVABBQAVAXACBQAWAYAVAQAXAUAQAVABBYAQAWAXAUAQAWAUAWAQAABUAQAVAVAZAQAWAWAWAQAVAVA9BQAWAXACBQAVAUAUAQAZAYAQAWAYAABQAVACBABQAVACBYAQAWAVABBQAVAABUAQAVAYAVAQAYAVAQAVAWACBQAWAYA9BQAVAVAWAQAVACBVAQAVABBWAQAVAUAQAVAXAZAQAXACBQAVAXAABQABBXAQAVAWAUAQAVACBCBQAWAUACBQAYAABQAWAXAABQAVAVAZAQAVACBVAQAWACBQAWAVAZAQA9BQAABCBQAZAXAQAXAWAQAWAZAXAQAVAYAABQAVAUAQAWAVAZAQAWAZAZAQAYABBQAWAYAYAQAVAVAQA9B9BQAVAZA9BQAWAVAYAQABBZAQAWAABQAWAVAZAQAVAAB9BQAYAXAQAYACBQAWAXAYAQAVAYA9BQACBXAQAVAABABQAABWAQAWAXAABQAVAUAYAQAVAVAXAQAWAXA9BQABBQAABXAQAVAABBBQAVABBYAQAWAYAABQA9BCBQAVAZAZAQAXAVAQAZAUAQAVAYA9BQAYAYAQAWAVABBQAVAUAVAQACBBBQAVA9BUAQAVABBBBQAVAYAQAWAWAXAQAVABBQAZAYAQAVACBWAQAWAXAXAQAZAVAQAXAZAQAVABBABQAWAUAXAQAVABBABQAXAZAQAWAUAABQAVAUAQA9BVAQAZAZAQA9BVAQAVA9BWAQAABCBQAVAVAXAQAVABBUAQAXAWAQAWAZAZAQAVAXAVAQAWAUA9BQAVAUAVAQAABQAVAUAZAQAVAZAVAQAVAVAUAQAWAVAUAQAYAABQAWAVAUAQAABQAVAWAQABBYAQACBABQAVAYAABQAVAVA9BQAXAVAQAVACBWAQAVACBWAQAVAYAABQAVAWAXAQAYAXAQAXAVAQAABUAQAABVAQAABUAQACBYAQAWAUA9BQAWAXABBQAWAVACBQAWAWA9BQA9BQAVAYAXAQAVAUAABQAYAABQAZABBQAVAVAUAQAWAWAZAQAVAWACBQAWAXAABQAXAZAQACBWAQAVAABZAQAABBBQAVAWA9BQAVAYAZAQAVACBYAQAWAYAXAQAVAXAABQAVAWAWAQACBUAQAWAUABBQAWAUAUAQAVACBUAQAWAYABBQA9BQAWAQAWAUAUAQAVAYAUAQAVAVAABQAVA9BYAQAVAXACBQAWAXAWAQAVAYAWAQAWAXAZAQAVAWAXAQAVAUAYAQAVAWAWAQAZAZAQAVAYABBQAVABBWAQAXAUAQAWAVAYAQAWAXAXAQAZABBQAVAZAZAQAVAYAZAQAVABBYAQAVAVAABQAWAWABBQAVACBUAQAXAZAQAVA9BZAQAVAWA9BQACBXAQAWAYAUAQAVAZA9BQAWAWACBQAXABBQAWAYAUAQAWAYAXAQAWAUACBQAABVAQAVAABZAQA9BQAVABBABQAUAQAVAYAWAQAVAYACBQAVAWACBQAZAZAQA9BQAYAABQAVAXAZAQAWAUACBQAVA9BWAQAWAXAUAQAVACBVAQAVAXAWAQACBBBQAVAABUAQAABCBQAXAABQAVAVAWAQAWAXAXAQAVABBQAYAXAQAWAUAWAQAWAXAUAQAWAWA9BQACBQABB9BQAWAUAVAQAWAYAUAQAVAZAUAQAVABBBBQAWACBQAVAYAWAQAWAQAVAXACBQABBABQAABBBQAVAXACBQAWAYAXAQABBZAQAABVAQAWAUAXAQAVAUAWAQAWAYAXAQAWAYAXAQAUAQAWAZAWAQAWAXAYAQAWAUAQAVAUAQAVABBCBQAWACBQAWAUA9BQAWAYAYAQAWAYAVAQAXAQAWAVAQAVAVAVAQAWAXAABQAWAWAVAQAWAVAUAQABBVAQAWAWA9BQAVACBYAQACBUAQAXAXAQAZAABQAVA9BQAYABBQAVA9BVAQAWAWAVAQACBCBQAZAWAQAABQAVAXAVAQAVAWAWAQACBABQAVAWAVAQAVAVAQAXAABQAVAABXAQAVA9BABQAVAAB9BQAVAZACBQAVAYAABQAWAYAUAQAVAVAQAVABBYAQAVAWA9BQAWAWAUAQAXAUAQAABWAQAVAYA9BQAWAYAXAQAVAWAVAQAVACBVAQACBUAQACB9BQAVAQAVAYA9BQAWAUAABQAVAUAVAQAYA9BQAABQAVAABCBQAVAUAVAQAVAAB9BQAVAUAWAQAVAXAYAQAVAWAVAQACBVAQAVA9BBBQAWAVAVAQAVAXAWAQAXAUAQAVAVAVAQAYAXAQAWAWA9BQAVAWABBQAVA9BYAQAVAZAQAZABBQAYAXAQABB9BQAVAXAXAQAYAQAWAZAVAQAWAWAZAQAVACBCBQAWAUAUAQAVABBYAQABBVAQAZAYAQAWAYAXAQAVAXABBQAVAZAYAQAVABBQAVAUAUAQAWAZAWAQAXAVAQAVAXAABQAVAWABBQAWAVAUAQAVAVA9BQAVACBBBQAWABBQAXAUAQAVABBQAVABBABQAYAYAQAVACBCBQAVAZAUAQAVAUAYAQAAB9BQACBYAQAVAWA9BQAVAQAVAYAZAQAVABBCBQAWAZAUAQAVABBWAQAWAXAZAQAABUAQAWAYAUAQAVAWAXAQAVAXACBQAVAABUAQAWAZAVAQAVAVAUAQAWAZAWAQAVACBABQAVA9BXAQAVACB9BQAVA9BWAQAVACBBBQAVAWAWAQAVAYAXAQAYAYAQAABWAQAZAQAVA9BUAQA9BWAQAXA9BQAZAABQAYAABQAWAYAZAQABBQAWAUAVAQAWAYAQAVACBYAQAWAVAUAQAVAXAUAQAWAWABBQAVAWAVAQAVAYA9BQAVABBYAQAZAXAQAVAZAUAQAVAVAABQAVAWAXAQAVAYACBQAVAUAUAQAZABBQAVACB9BQAVAABVAQAWAUAQAVAABABQA9BZAQAWAYAVAQAABVAQAVAUABBQAVAYAUAQAVAVAWAQAWAYAVAQAVABBABQAVACBCBQA9BYAQAYAXAQAABYAQAXABBQAVAVAYAQAVAXAXAQAVAUACBQACBCBQA9BZAQAWAXAWAQAVAZAQAVAWAYAQAWAZAVAQAVAABVAQAVAUAQAWAWAUAQAABQAVAABQAYAUAQA9BVAQAWAVAXAQAWACBQAABXAQAVAWAABQAVAXA9BQAWAUABBQAXAABQAVAUAXAQAWAWAUAQAVAVAABQAVAUAZAQAWAVAQACBXAQAVAYAUAQAYAUAQAVAVAYAQAWAUAYAQAVACBVAQAVAYABBQAVAVABBQAVACBXAQAZACBQAVACBABQAWAVABBQAVA9B9BQAWAVAZAQAWAXAWAQAWAWA9BQAZAQAWAZAYAQAWAYAYAQAVAABBBQAVAABYAQAVAYAYAQAZACBQAWAXAWAQAVACBZAQAWAUAVAQAVAABZAQAWAYAZAQAWAYA9BQAVAVAVAQAWAVAWAQAVAZAZAQAVA9BBBQAXAWAQAVAWA9BQAVAYAVAQA9BYAQAVABBZAQAZAQAYAYAQAVAUAYAQAVAVAABQAVAVAXAQAWAWA9BQAVA9BWAQA9BVAQAWAWABBQAVAVAUAQAVAYAZAQACB9BQAVAUAXAQAVACBQAVACBXAQAZAWAQACBYAQAWAUACBQACBABQACBZAQAVAVAUAQAXAVAQAVAUAABQAWAYAXAQAWAXAWAQAVAWAXAQAVABBCBQAVAABUAQAVAYA9BQABBZAQAWAYAUAQAVAWAZAQAVACBABQAWAABQABBABQAABUAQAAB9BQAWAVAYAQAWAXAXAQA9BXAQAXAZAQAVACB9BQAVAUABBQAVAUAXAQAWAXAABQA9BYAQABBCBQAWAZAXAQAVAWABBQAYAWAQAVAVAXAQACBQACBQAWABBQAVAWABBQAVABBZAQAVA9BWAQAWAWAQAWAYACBQAVAWAYAQAVAABUAQAZAVAQAZAZAQAWAYACBQAVAVAWAQAABZAQAVABBCBQAWAWAXAQAWAWAZAQA9BVAQACBUAQAWAWAUAQAVAQAVAUAZAQAVA9BUAQAWAUAABQAVACBVAQAXAQAVAZAYAQAVAUAXAQAWAVA9BQAVAABBBQAVAWAUAQA9BABQAYAABQAVAVACBQACBYAQAVAXACBQAVAVAXAQAWAWAUAQAVABBCBQAXAXAQAVABBUAQAVAUAYAQAXAYAQAZACBQAWAXAYAQAVAYABBQAVAYAYAQAVACBBBQAYAUAQAXAZAQAWAYAUAQAZAXAQAWAWAVAQAWAYAABQAWAVAZAQAVABBUAQAVA9BWAQAVAYAUAQAWAXABBQAVAWAUAQAWAXAVAQAVA9BZAQAVAXACBQAVA9BQAVAXAYAQAVAXAZAQA9BBBQAWAXAUAQAVABBCBQAVAZAXAQAVAABABQAVA9BZAQAWAYAWAQAWAXAYAQAWAXAWAQAVA9BCBQAYACBQAXAWAQAVACBYAQAVAXAVAQAYA9BQAXAZAQAAB9BQAWAYAZAQAVAWABBQAZAABQAVAUACBQAXAXAQAWAUAZAQAWAXAVAQAVA9BABQAWAXAVAQAWAWAVAQAVABBYAQACBCBQAWAWAYAQAVABBCBQAYAZAQAVAZAQAWAWAWAQAVAXAYAQAWAVAVAQAVAABQAVAUAXAQAVAYAQAVAWAXAQAWAVAVAQA9BCBQAWAVAUAQAZAABQAWAWAZAQAXAVAQAVAUAQAWAVAXAQAVAXAZAQAWAYAQAVACBVAQAWAXABBQAVAXAABQAVAYAZAQAWAUAZAQAVAWABBQAVAWA9BQAVAWAWAQAVAWAWAQAWAYAZAQAXAXAQAVABBUAQAVAWABBQAVACBXAQAVAUAZAQABB9BQAVAXAVAQAWAXAXAQAWAWAABQAVAUAZAQAWAYAWAQAVAVACBQAWAZAZAQAVAZAQAYAABQAZAWAQAWAZAZAQAVA9BCBQA9BQAXABBQABBABQAVABBUAQAYAVAQACBXAQAXAZAQACBWAQAWAYAXAQAWAYAZAQAVAYAXAQAVAZAABQAWAWACBQAVAWABBQAVABBVAQAVAXAQAVACBVAQAYAYAQAZA9BQAWAXAABQACBWAQA9B9BQAVAWACBQAWAWABBQAVAWACBQAWAUAVAQAWAYACBQAVAWABBQAWAWAYAQABBCBQAVAZAZAQABBXAQAVAUA9BQAVAWAABQAWAUAVAQAVAXAABQAVAABWAQAWAUAYAQAWAVACBQAABQAVABB9BQAVAVACBQAWAUAABQAWAVAQAWAVAABQAVACBABQAXAYAQAVAVABBQAVAXAQA9BWAQAVAQAWAWAUAQAWAWAUAQAVAABCBQAVABBWAQAVAXAXAQAWAUABBQAVACBVAQAVACBZAQAWAVAWAQAVABB9BQAABUAQAVACBQAABYAQAVAVAXAQAZABBQAVACBUAQAVAYAYAQAVAABBBQAVAUAABQAVAXAYAQAWAWAWAQAWAWABBQAVAZA9BQAVAZAQAABVAQAVA9BUAQAWAZAVAQAWAABQAVAXABBQAWAVA9BQAVAVA9BQAYACBQAZACBQAVAXAUAQAVAXAWAQACBWAQAVACBUAQAVAYAABQAVAVAABQAABBBQACBUAQAVAUAZAQABBWAQAWAVAZAQAWAYAQACBXAQAWAUAXAQAVAABBBQAXAVAQAVAWAUAQAVAZAABQAVAZABBQAXA9BQAZAQAVAXABBQAVA9BXAQAVABBXAQAWAVACBQAVA9BWAQAWAVA9BQAWAWAVAQAVAZAUAQAVAZAYAQAWAVAWAQAVAYAZAQAWAVABBQAZAQAWAWAABQAVAXAQAWAVAUAQABB9BQAWAUAYAQAZACBQAVAWAZAQAWAVAQAZACBQAWAVAVAQAZACBQAYACBQAZACBQAABCBQAVABBZAQAVAYAQAYAWAQAVAWAWAQAYAYAQAWAZAWAQAVA9BBBQAWAVAYAQAWAWABBQAVAZAWAQAWAXAUAQAVAXACBQA9BABQACBWAQAWAVACBQAXA9BQAVACBUAQAVACBZAQAZABBQAWAZAQABB9BQACBZAQAWAWAUAQAABVAQAABZAQABBVAQAWAXAABQAWAYAUAQAYAVAQAVAWAZAQAVAZAZAQAWAXABBQAWAWAWAQAVAZAWAQAVA9BUA',
  startDate: new DateTag(2019, 5, 10),
};
const message = Converter.asciiToTrytes(JSON.stringify(requestMsg));
const tagStr = requestMsg.startDate.toString();
const TAG = Converter.asciiToTrytes(tagStr);
const transfers: Transfer[] = [
  {
    value: 0,
    tag: TAG,
    address,
    message,
  },
];

iota
  .prepareTransfers(seed, transfers)
  .then(trytes => {
    return iota.sendTrytes(trytes, 3 /*depth*/, 14 /*MWM*/);
  })
  .then(bundle => {
    const JSONBundle = JSON.stringify(bundle, null, 1);
    console.log(`Bundle: ${JSONBundle}`);
  })
  .catch(err => {
    // Catch any errors
    console.log(err);
  });
